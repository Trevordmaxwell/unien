# Phase-B Grid Sweep Report

Corpus: data/tiny_shakespeare_excerpt.txt

## Mini Summary

- Best by ppl: T3_k32_wmf_be1.2 (ppl=1.063, ms/tok=21.67)
- Best by speed: T1_k16_kl_be1.5 (ms/tok=1.58, ppl=1.140)
- Best efficiency: T1_k16_kl_be1.5 (ppl*ms/tok=1.806)

## Summary

| label | ppl | decode ms/token | forward ms/token | iters/token | epochs | tokens | total s | T | k | wmf | beta_end |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| T1_k16_kl_be1.2 | 1.143 | 1.69 | 0.01 | 0.000 | 5 | 537600 | 24.1 | 1 | 16 | 0 | 1.2 |
| T1_k16_kl_be1.5 | 1.140 | 1.58 | 0.01 | 0.000 | 5 | 537600 | 23.7 | 1 | 16 | 0 | 1.5 |
| T1_k16_wmf_be1.2 | 1.114 | 3.66 | 0.03 | 0.000 | 5 | 537600 | 43.8 | 1 | 16 | 0 | 1.2 |
| T1_k16_wmf_be1.5 | 1.106 | 3.76 | 0.03 | 0.000 | 5 | 537600 | 42.9 | 1 | 16 | 0 | 1.5 |
| T1_k32_kl_be1.2 | 1.137 | 1.91 | 0.02 | 0.000 | 5 | 537600 | 27.6 | 1 | 32 | 0 | 1.2 |
| T1_k32_kl_be1.5 | 1.129 | 1.93 | 0.02 | 0.000 | 5 | 537600 | 28.1 | 1 | 32 | 0 | 1.5 |
| T1_k32_wmf_be1.2 | 1.111 | 10.65 | 0.08 | 0.000 | 5 | 537600 | 67.8 | 1 | 32 | 0 | 1.2 |
| T1_k32_wmf_be1.5 | 1.113 | 7.86 | 0.08 | 0.000 | 5 | 537600 | 66.8 | 1 | 32 | 0 | 1.5 |
| T2_k16_kl_be1.2 | 1.155 | 2.55 | 0.02 | 0.000 | 5 | 537600 | 31.0 | 2 | 16 | 0 | 1.2 |
| T2_k16_kl_be1.5 | 1.132 | 2.58 | 0.02 | 0.000 | 5 | 537600 | 30.9 | 2 | 16 | 0 | 1.5 |
| T2_k16_wmf_be1.2 | 1.096 | 5.95 | 0.06 | 0.000 | 5 | 537600 | 59.4 | 2 | 16 | 0 | 1.2 |
| T2_k16_wmf_be1.5 | 1.102 | 6.50 | 0.06 | 0.000 | 5 | 537600 | 60.0 | 2 | 16 | 0 | 1.5 |
| T2_k32_kl_be1.2 | 1.132 | 2.96 | 0.03 | 0.000 | 5 | 537600 | 35.1 | 2 | 32 | 0 | 1.2 |
| T2_k32_kl_be1.5 | 1.131 | 3.03 | 0.03 | 0.000 | 5 | 537600 | 35.4 | 2 | 32 | 0 | 1.5 |
| T2_k32_wmf_be1.2 | 1.137 | 14.16 | 0.15 | 0.000 | 5 | 537600 | 106.4 | 2 | 32 | 0 | 1.2 |
| T2_k32_wmf_be1.5 | 1.108 | 14.13 | 0.15 | 0.000 | 5 | 537600 | 107.9 | 2 | 32 | 0 | 1.5 |
| T3_k16_kl_be1.2 | 1.137 | 3.57 | 0.03 | 0.000 | 5 | 537600 | 36.9 | 3 | 16 | 0 | 1.2 |
| T3_k16_kl_be1.5 | 1.150 | 3.45 | 0.03 | 0.000 | 5 | 537600 | 37.0 | 3 | 16 | 0 | 1.5 |
| T3_k16_wmf_be1.2 | 1.078 | 9.61 | 0.09 | 0.000 | 5 | 537600 | 76.5 | 3 | 16 | 0 | 1.2 |
| T3_k16_wmf_be1.5 | 1.082 | 9.13 | 0.09 | 0.000 | 5 | 537600 | 76.4 | 3 | 16 | 0 | 1.5 |
| T3_k32_kl_be1.2 | 1.146 | 3.99 | 0.04 | 0.000 | 5 | 537600 | 41.7 | 3 | 32 | 0 | 1.2 |
| T3_k32_kl_be1.5 | 1.126 | 4.99 | 0.05 | 0.000 | 5 | 537600 | 43.6 | 3 | 32 | 0 | 1.5 |
| T3_k32_wmf_be1.2 | 1.063 | 21.67 | 0.23 | 0.000 | 5 | 537600 | 146.4 | 3 | 32 | 0 | 1.2 |
| T3_k32_wmf_be1.5 | 1.087 | 21.65 | 0.23 | 0.000 | 5 | 537600 | 146.7 | 3 | 32 | 0 | 1.5 |

## Pareto (ppl vs decode ms/token)

- T3_k32_wmf_be1.2: ppl=1.063, ms/token=21.67 (T=3, k=32, wmf=0, be=1.2)
- T3_k16_wmf_be1.2: ppl=1.078, ms/token=9.61 (T=3, k=16, wmf=0, be=1.2)
- T3_k16_wmf_be1.5: ppl=1.082, ms/token=9.13 (T=3, k=16, wmf=0, be=1.5)
- T2_k16_wmf_be1.2: ppl=1.096, ms/token=5.95 (T=2, k=16, wmf=0, be=1.2)
- T1_k16_wmf_be1.5: ppl=1.106, ms/token=3.76 (T=1, k=16, wmf=0, be=1.5)
- T1_k16_wmf_be1.2: ppl=1.114, ms/token=3.66 (T=1, k=16, wmf=0, be=1.2)
- T1_k32_kl_be1.5: ppl=1.129, ms/token=1.93 (T=1, k=32, wmf=0, be=1.5)
- T1_k32_kl_be1.2: ppl=1.137, ms/token=1.91 (T=1, k=32, wmf=0, be=1.2)
- T1_k16_kl_be1.5: ppl=1.140, ms/token=1.58 (T=1, k=16, wmf=0, be=1.5)

## Plots

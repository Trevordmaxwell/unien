# Phase-B Grid Sweep Report

Corpus: data/tiny_shakespeare_excerpt.txt

## Mini Summary

- Best by ppl: T3_k16_kl_beta1.5 (ppl=1.187, ms/tok=3.60)
- Best by speed: T1_k16_kl_beta1.2 (ms/tok=1.57, ppl=1.196)
- Best efficiency: T1_k16_kl_beta1.2 (ppl*ms/tok=1.880)

## Summary

| label | ppl | decode ms/token | forward ms/token | iters/token | epochs | tokens | total s | T | k | wmf | beta_end |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| T1_k16_kl_beta1.2 | 1.196 | 1.57 | 0.01 | 0.004 | 2 | 215040 | 9.6 | 1 | 16 | 0 | 1.2 |
| T1_k16_kl_beta1.5 | 1.198 | 1.69 | 0.01 | 0.004 | 2 | 215040 | 9.5 | 1 | 16 | 0 | 1.5 |
| T1_k16_wmf_beta1.2 | 1.204 | 3.55 | 0.03 | 0.004 | 2 | 215040 | 16.5 | 1 | 16 | 1 | 1.2 |
| T1_k16_wmf_beta1.5 | 1.206 | 3.41 | 0.03 | 0.004 | 2 | 215040 | 16.6 | 1 | 16 | 1 | 1.5 |
| T1_k32_kl_beta1.2 | 1.193 | 1.69 | 0.02 | 0.004 | 2 | 215040 | 10.6 | 1 | 32 | 0 | 1.2 |
| T1_k32_kl_beta1.5 | 1.193 | 1.95 | 0.02 | 0.004 | 2 | 215040 | 10.9 | 1 | 32 | 0 | 1.5 |
| T1_k32_wmf_beta1.2 | 1.208 | 10.39 | 0.08 | 0.004 | 2 | 215040 | 26.4 | 1 | 32 | 1 | 1.2 |
| T1_k32_wmf_beta1.5 | 1.211 | 7.28 | 0.08 | 0.004 | 2 | 215040 | 26.6 | 1 | 32 | 1 | 1.5 |
| T2_k16_kl_beta1.2 | 1.200 | 2.65 | 0.02 | 0.008 | 2 | 215040 | 12.4 | 2 | 16 | 0 | 1.2 |
| T2_k16_kl_beta1.5 | 1.189 | 2.82 | 0.02 | 0.008 | 2 | 215040 | 12.4 | 2 | 16 | 0 | 1.5 |
| T2_k16_wmf_beta1.2 | 1.205 | 6.27 | 0.06 | 0.008 | 2 | 215040 | 23.7 | 2 | 16 | 1 | 1.2 |
| T2_k16_wmf_beta1.5 | 1.199 | 6.03 | 0.06 | 0.008 | 2 | 215040 | 23.8 | 2 | 16 | 1 | 1.5 |
| T2_k32_kl_beta1.2 | 1.195 | 3.16 | 0.03 | 0.008 | 2 | 215040 | 14.0 | 2 | 32 | 0 | 1.2 |
| T2_k32_kl_beta1.5 | 1.193 | 3.04 | 0.03 | 0.008 | 2 | 215040 | 13.8 | 2 | 32 | 0 | 1.5 |
| T2_k32_wmf_beta1.2 | 1.214 | 13.53 | 0.14 | 0.008 | 2 | 215040 | 41.7 | 2 | 32 | 1 | 1.2 |
| T2_k32_wmf_beta1.5 | 1.197 | 13.44 | 0.15 | 0.008 | 2 | 215040 | 42.1 | 2 | 32 | 1 | 1.5 |
| T3_k16_kl_beta1.2 | 1.194 | 3.56 | 0.03 | 0.012 | 2 | 215040 | 14.7 | 3 | 16 | 0 | 1.2 |
| T3_k16_kl_beta1.5 | 1.187 | 3.60 | 0.03 | 0.012 | 2 | 215040 | 14.7 | 3 | 16 | 0 | 1.5 |
| T3_k16_wmf_beta1.2 | 1.211 | 9.90 | 0.09 | 0.012 | 2 | 215040 | 30.8 | 3 | 16 | 1 | 1.2 |
| T3_k16_wmf_beta1.5 | 1.209 | 9.09 | 0.10 | 0.012 | 2 | 215040 | 30.5 | 3 | 16 | 1 | 1.5 |
| T3_k32_kl_beta1.2 | 1.197 | 4.07 | 0.04 | 0.012 | 2 | 215040 | 16.6 | 3 | 32 | 0 | 1.2 |
| T3_k32_kl_beta1.5 | 1.195 | 4.04 | 0.04 | 0.012 | 2 | 215040 | 16.7 | 3 | 32 | 0 | 1.5 |
| T3_k32_wmf_beta1.2 | 1.205 | 20.43 | 0.21 | 0.012 | 2 | 215040 | 57.3 | 3 | 32 | 1 | 1.2 |
| T3_k32_wmf_beta1.5 | 1.208 | 21.84 | 0.22 | 0.012 | 2 | 215040 | 57.4 | 3 | 32 | 1 | 1.5 |

## Pareto (ppl vs decode ms/token)

- T3_k16_kl_beta1.5: ppl=1.187, ms/token=3.60 (T=3, k=16, wmf=0, be=1.5)
- T2_k16_kl_beta1.5: ppl=1.189, ms/token=2.82 (T=2, k=16, wmf=0, be=1.5)
- T1_k32_kl_beta1.2: ppl=1.193, ms/token=1.69 (T=1, k=32, wmf=0, be=1.2)
- T1_k16_kl_beta1.2: ppl=1.196, ms/token=1.57 (T=1, k=16, wmf=0, be=1.2)

## Plots

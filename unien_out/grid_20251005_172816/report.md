# Phase-B Grid Sweep Report

Corpus: data/tiny_shakespeare_excerpt.txt

## Mini Summary

- Best by ppl: T3_k16_wmf_be1.5 (ppl=1.078, ms/tok=9.32)
- Best by speed: T1_k16_kl_be1.2 (ms/tok=1.57, ppl=1.143)
- Best efficiency: T1_k16_kl_be1.5 (ppl*ms/tok=1.785)

## Summary

| label | ppl | decode ms/token | forward ms/token | iters/token | epochs | tokens | total s | T | k | wmf | beta_end |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| T1_k16_kl_be1.2 | 1.143 | 1.57 | 0.01 | 0.004 | 5 | 537600 | 23.4 | 1 | 16 | 0 | 1.2 |
| T1_k16_kl_be1.5 | 1.125 | 1.59 | 0.01 | 0.004 | 5 | 537600 | 23.1 | 1 | 16 | 0 | 1.5 |
| T1_k16_wmf_be1.2 | 1.108 | 3.63 | 0.03 | 0.004 | 5 | 537600 | 41.1 | 1 | 16 | 1 | 1.2 |
| T1_k16_wmf_be1.5 | 1.115 | 3.56 | 0.03 | 0.004 | 5 | 537600 | 42.0 | 1 | 16 | 1 | 1.5 |
| T1_k32_kl_be1.2 | 1.125 | 1.90 | 0.02 | 0.004 | 5 | 537600 | 27.1 | 1 | 32 | 0 | 1.2 |
| T1_k32_kl_be1.5 | 1.140 | 1.94 | 0.02 | 0.004 | 5 | 537600 | 27.2 | 1 | 32 | 0 | 1.5 |
| T1_k32_wmf_be1.2 | 1.112 | 11.14 | 0.08 | 0.004 | 5 | 537600 | 66.2 | 1 | 32 | 1 | 1.2 |
| T1_k32_wmf_be1.5 | 1.115 | 8.15 | 0.08 | 0.004 | 5 | 537600 | 66.3 | 1 | 32 | 1 | 1.5 |
| T2_k16_kl_be1.2 | 1.144 | 2.56 | 0.02 | 0.008 | 5 | 537600 | 29.8 | 2 | 16 | 0 | 1.2 |
| T2_k16_kl_be1.5 | 1.149 | 2.57 | 0.02 | 0.008 | 5 | 537600 | 29.6 | 2 | 16 | 0 | 1.5 |
| T2_k16_wmf_be1.2 | 1.127 | 6.31 | 0.06 | 0.008 | 5 | 537600 | 58.0 | 2 | 16 | 1 | 1.2 |
| T2_k16_wmf_be1.5 | 1.104 | 6.28 | 0.06 | 0.008 | 5 | 537600 | 57.7 | 2 | 16 | 1 | 1.5 |
| T2_k32_kl_be1.2 | 1.146 | 3.00 | 0.03 | 0.008 | 5 | 537600 | 34.6 | 2 | 32 | 0 | 1.2 |
| T2_k32_kl_be1.5 | 1.145 | 2.92 | 0.03 | 0.008 | 5 | 537600 | 35.0 | 2 | 32 | 0 | 1.5 |
| T2_k32_wmf_be1.2 | 1.112 | 14.80 | 0.15 | 0.008 | 5 | 537600 | 105.2 | 2 | 32 | 1 | 1.2 |
| T2_k32_wmf_be1.5 | 1.114 | 15.12 | 0.15 | 0.008 | 5 | 537600 | 105.3 | 2 | 32 | 1 | 1.5 |
| T3_k16_kl_be1.2 | 1.126 | 3.41 | 0.03 | 0.012 | 5 | 537600 | 35.8 | 3 | 16 | 0 | 1.2 |
| T3_k16_kl_be1.5 | 1.148 | 3.63 | 0.03 | 0.012 | 5 | 537600 | 36.5 | 3 | 16 | 0 | 1.5 |
| T3_k16_wmf_be1.2 | 1.085 | 9.40 | 0.09 | 0.012 | 5 | 537600 | 76.2 | 3 | 16 | 1 | 1.2 |
| T3_k16_wmf_be1.5 | 1.078 | 9.32 | 0.09 | 0.012 | 5 | 537600 | 76.1 | 3 | 16 | 1 | 1.5 |
| T3_k32_kl_be1.2 | 1.119 | 4.48 | 0.04 | 0.012 | 5 | 537600 | 42.2 | 3 | 32 | 0 | 1.2 |
| T3_k32_kl_be1.5 | 1.126 | 4.11 | 0.04 | 0.012 | 5 | 537600 | 42.8 | 3 | 32 | 0 | 1.5 |
| T3_k32_wmf_be1.2 | 1.097 | 21.81 | 0.23 | 0.012 | 5 | 537600 | 145.4 | 3 | 32 | 1 | 1.2 |
| T3_k32_wmf_be1.5 | 1.093 | 23.08 | 0.23 | 0.012 | 5 | 537600 | 144.2 | 3 | 32 | 1 | 1.5 |

## Pareto (ppl vs decode ms/token)

- T3_k16_wmf_be1.5: ppl=1.078, ms/token=9.32 (T=3, k=16, wmf=1, be=1.5)
- T2_k16_wmf_be1.5: ppl=1.104, ms/token=6.28 (T=2, k=16, wmf=1, be=1.5)
- T1_k16_wmf_be1.2: ppl=1.108, ms/token=3.63 (T=1, k=16, wmf=1, be=1.2)
- T1_k16_wmf_be1.5: ppl=1.115, ms/token=3.56 (T=1, k=16, wmf=1, be=1.5)
- T1_k32_kl_be1.2: ppl=1.125, ms/token=1.90 (T=1, k=32, wmf=0, be=1.2)
- T1_k16_kl_be1.5: ppl=1.125, ms/token=1.59 (T=1, k=16, wmf=0, be=1.5)
- T1_k16_kl_be1.2: ppl=1.143, ms/token=1.57 (T=1, k=16, wmf=0, be=1.2)

## Plots
